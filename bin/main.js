// Generated by CoffeeScript 1.10.0
(function() {
  var Thingy;

  Thingy = require("./thingy");

  Thingy.add("test1", function(magic) {
    return {
      init: function() {
        return console.log("Test 1");
      },
      destroy: function() {
        return console.log("Poof 1");
      }
    };
  });

  Thingy.add("test2", function(magic) {
    return {
      init: function() {
        console.log("Test 2");
        return this.talk();
      },
      talk: function() {
        return setInterval((function() {
          return magic.cast({
            name: "new-message",
            data: {
              name: "aewens",
              text: "he does things"
            }
          });
        }), 200);
      },
      destroy: function() {
        return console.log("Poof 2");
      }
    };
  });

  Thingy.add("test3", function(magic) {
    return {
      init: function() {
        console.log("Test 3");
        return magic.listen("new-message", this.talk, this);
      },
      talk: function(data) {
        console.log(data.name + ", " + data.text + ".");
        return this.hush();
      },
      hush: function() {
        magic.silence("new-message", this.talk);
        return console.log("Control-C to exit");
      },
      destroy: function() {
        return console.log("Poof 3");
      }
    };
  });

  Thingy.start("test1").then(function() {
    return Thingy.start("test2");
  });

  Thingy.start("test3");

}).call(this);
